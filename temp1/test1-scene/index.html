<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Test1 Scene</title>
    <meta name="description" content="Test1 Scene">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="./main.js"></script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <img id="groundTexture" src="https://cdn.aframe.io/a-painter/images/floor.jpg" crossorigin="anonymous">
        <img id="skyTexture" src="https://cdn.aframe.io/a-painter/images/sky.jpg" crossorigin="anonymous">
        <img id="wallaby" src="https://raw.githubusercontent.com/desertpy/presentations/master/exploring-numpy-godber/wallaby_746_600x450.jpg" crossorigin="anonymous">
      </a-assets>

      <!-- Primitives. -->
      <a-image position="0 1.35 -5" src="#wallaby"></a-image>

      <!-- Background sky. -->
      <a-sky height="2048" radius="30" src="#skyTexture" theta-length="90" width="2048"></a-sky>

      <!-- Ground. -->
      <a-circle src="#groundTexture" rotation="-90 0 0" radius="32"></a-circle>      
    </a-scene>
    <script type="module">
      import * as THREE from '../build/three.module.js';
      import { VolumeRenderShader1 } from './VolumeShader.js';


      // create a 256x256x256 array full of zeros
      let tristogram = Array(256).fill().map(
        () => Array(256).fill().map(
          () => Array(256).fill(0)
          )
        );

      const loader = new THREE.TextureLoader();
      loader.load('https://raw.githubusercontent.com/desertpy/presentations/master/exploring-numpy-godber/wallaby_746_600x450.jpg', (texture) => {
        const image = getImageData(texture.image);
        for (let x = 0; x < image.width; x++) {
          for (let y = 0; y < image.height; y++) {
            let p = getPixel(image, x, y)
            tristogram[p.r][p.g][p.b] = tristogram[p.r][p.g][p.b]++
          }
        }
      });
    </script>
  </body>
</html>
